.\"
.\" Copyright (C) 2014 Red Hat, Inc. All Rights Reserved.
.\" Written by David Howells (dhowells@redhat.com)
.\"
.\" %%%LICENSE_START(GPLv2+_SW_ONEPARA)
.\" This program is free software; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public Licence
.\" as published by the Free Software Foundation; either version
.\" 2 of the Licence, or (at your option) any later version.
.\" %%%LICENSE_END
.\"
.TH "PERSISTENT-KEYRING" 7 2016-11-01 Linux "Linux Programmer's Manual"
.\"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
.SH NAME
persistent-keyring \- per-user persistent keyring
.SH DESCRIPTION
The persistent keyring is a keyring used to anchor keys on behalf of a user.
Each UID the kernel deals with has its own persistent keyring that
is shared between all threads owned by that UID.
.P
The persistent keyring is created on demand when a thread requests it.
The keyring's expiration timer is reset every time it is accessed
to the value in:
.IP
/proc/sys/kernel/keys/persistent_keyring_expiry
.P
The persistent keyring is not searched by \fBrequest_key\fP() unless it is
referred to by a keyring that is.
.P
The persistent keyring may not be accessed directly, even by processes with
the appropriate UID.
Instead it must be linked to one of a process's keyrings
first before that keyring can access it by virtue of its possessor permits.
This is done with \fBkeyctl_get_persistent\fP().
.P
Persistent keyrings are independent of
.BR clone (2),
.BR fork (2),
.BR vfork (2),
.BR execve (2),
and
.BR _exit (2).
They persist until their expiration timers trigger - at which point
they are garbage collected.
This allows them to carry keys beyond the life of
the kernel's record of the corresponding UID (the destruction of which results
in the destruction of the user and user session keyrings).
.P
If a persistent keyring does not exist when it is accessed, it will be
created.
.SH SPECIAL OPERATIONS
The keyutils library provides a special operation for manipulating persistent
keyrings:
.IP \fBkeyctl_get_persistent\fP()
This operation allows the caller to get the persistent keyring corresponding
to their own UID or, if they have
.BR CAP_SETUID ,
the persistent keyring
corresponding to some other UID in the same user namespace.
.\"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
.SH SEE ALSO
.ad l
.nh
.BR keyctl (1),
.BR keyctl (3),
.BR keyctl_get_persistent (3),
.BR keyrings (7),
.BR process\-keyring (7),
.BR session\-keyring (7),
.BR thread\-keyring (7),
.BR user\-keyring (7),
.BR user\-session\-keyring (7)
